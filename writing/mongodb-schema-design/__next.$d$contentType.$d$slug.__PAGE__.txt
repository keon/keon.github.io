1:"$Sreact.fragment"
2:I[28388,["/_next/static/chunks/7f64245c6154235a.js","/_next/static/chunks/1ca67093247280ae.js"],"RelativeTime"]
24:I[98427,["/_next/static/chunks/fec5ea6183d0e55b.js","/_next/static/chunks/3b60e5197848a126.js"],"OutletBoundary"]
25:"$Sreact.suspense"
0:{"buildId":"ytgr4ScHVKxxVOmg1QY7t","rsc":["$","$1","c",{"children":[["$","section",null,{"children":[["$","h1",null,{"className":"title font-bold text-lg","children":"Rules of Thumb for MongoDB Schema Design"}],["$","div",null,{"className":"flex justify-between items-center mt-1 mb-6 text-xs","children":["$","$L2",null,{"date":"2017-01-11"}]}],["$","article",null,{"className":"prose","children":[["$","p",null,{"children":["This is a summary of ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-1","children":"6 Rules of Thumb for MongoDB Schema Design"}],", which details how MongoDB schemas should be organized in three separate blog posts. So please take a look if this summarization is not sufficient."]}],"\n",["$","p",null,{"children":"If you are new to MongoDB it is natural to ask how should one structure the schema for One-to-Many relationship."}],"\n",["$","h2",null,{"id":"basics","children":[[["$","a","link-basics",{"href":"#basics","className":"anchor"}]],"Basics"]}],"\n",["$","p",null,{"children":"Relationships can be in three different forms:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"One-to-Few"}],"\n",["$","li",null,{"children":"One-to-Many"}],"\n",["$","li",null,{"children":"One-to-Squillions"}],"\n"]}],"\n",["$","p",null,{"children":"Each method for structuring has its pros and cons. So the user should know how to decide which one is better than the other in the given situation."}],"\n",["$","h2",null,{"id":"one-to-few","children":[[["$","a","link-one-to-few",{"href":"#one-to-few","className":"anchor"}]],"One-to-Few"]}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// person"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  name"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"\"Keon Kim\""}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  hometown"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"\"Seoul\""}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  addresses"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": ["}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    { city: "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'Manhattan'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":", state: "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'NY'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":", cc: "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'USA'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" },"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    { city: "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'Jersey City'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":", state: "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'NJ'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":", cc: "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'USA'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" }"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"  ]"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}]]}]}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"Pros"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"You can call all the information in one query"}],"\n"]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"Cons"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"It is impossible to search the contained entity independently."}],"\n"]}],"\n",["$","h2",null,{"id":"one-to-many","children":[[["$","a","link-one-to-many",{"href":"#one-to-many","className":"anchor"}]],"One-to-Many"]}],"\n","$L3","\n","$L4","\n","$L5","\n","$L6","\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b"]}]]}],["$L1c"],"$L1d"]}],"loading":null,"isPartial":false}
3:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// parts"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  _id"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'AAAA'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  partno"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'123-aff-456'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  name"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'Awesometel 100Ghz CPU'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  qty"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"102"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  cost"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1.21"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  price"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"3.99"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// products"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  name"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'Weird Computer WC-3020'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  manufacturer"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'Haruair Eng.'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  catalog_number"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1234"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  parts"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": ["}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'AAAA'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'DEFO'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'EJFW'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"  ]"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}]]}]}]}]
4:["$","p",null,{"children":"Parent holds the list of ObjectID of the child documents. This requires an application level join, not the database level join."}]
5:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// find product based on category_number."}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#F97583"},"children":">"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" product "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" db.products."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"findOne"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({catalog_number: "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1234"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"});"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// find all parts in the product's parts list."}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#F97583"},"children":">"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" product_parts "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" db.parts."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"find"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                      _id: { $in : product.parts }"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                   })."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"toArray"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"();"}]]}]]}]}]}]
6:["$","p",null,{"children":["$","strong",null,{"children":"Pros"}]}]
7:["$","ul",null,{"children":["\n",["$","li",null,{"children":"It is easy to handle insert, delete on each documents independently."}],"\n",["$","li",null,{"children":"It has flexibility for implementing N-to-N relationship because it is an application level join."}],"\n"]}]
8:["$","p",null,{"children":["$","strong",null,{"children":"Cons"}]}]
9:["$","ul",null,{"children":["\n",["$","li",null,{"children":"Performance drops as you call documents multiple times."}],"\n"]}]
a:["$","h2",null,{"id":"one-to-squillions","children":[[["$","a","link-one-to-squillions",{"href":"#one-to-squillions","className":"anchor"}]],"One-to-Squillions"]}]
b:["$","p",null,{"children":"If you need to store tons of data (ie. event logs), you need to use a different approach since a document cannot be larger than 16MB in size. You need to use 'parent-referencing'."}]
c:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// host"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  _id"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'AAAB'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  name"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'goofy.example.com'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  ipaddr"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'127.66.66.66'"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// logmsg"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  time"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ISODate"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"\"2015-09-02T09:10:09.032Z\""}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  message"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'cpu is on fire!'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  host"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'AAAB'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":")       "}],["$","span",null,{"style":{"color":"#6A737D"},"children":"// references Host document"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}]]}]}]}]
d:["$","p",null,{"children":"Later you can join like below:"}]
e:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// Search parent host document"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#F97583"},"children":">"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" host "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" db.hosts."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"findOne"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({ipaddr : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'127.66.66.66'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"});"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// Search the most recent 5000 logs"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// for a host based on host's ObjectID"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#F97583"},"children":">"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" last_5k_msg "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" db.logmsg."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"find"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({host: host._id})"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                         ."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"sort"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({time : "}],["$","span",null,{"style":{"color":"#F97583"},"children":"-"}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"})"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                         ."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"limit"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"5000"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                         ."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"toArray"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"()"}]]}]]}]}]}]
f:["$","h2",null,{"id":"denormalization","children":[[["$","a","link-denormalization",{"href":"#denormalization","className":"anchor"}]],"Denormalization"]}]
10:["$","p",null,{"children":"In order to speed up the query, you can denormalize the data."}]
11:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// logmsg - before"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  time"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ISODate"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"\"2015-09-02T09:10:09.032Z\""}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  message"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'cpu is on fire!'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  host"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'AAAB'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// logmsg - after"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  time"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ISODate"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"\"2015-09-02T09:10:09.032Z\""}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  message"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'cpu is on fire!'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  host"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":": "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ObjectID"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'AAAB'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"  ipaddr"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'127.66.66.66'"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}]]}]}]}]
12:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#F97583"},"children":">"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" last_5k_msg "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" db.logmsg."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"find"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({ipaddr : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'127.66.66.66'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"})"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                         ."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"sort"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({time : "}],["$","span",null,{"style":{"color":"#F97583"},"children":"-"}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"})"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                         ."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"limit"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"5000"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":")"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"                         ."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"toArray"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"()"}]]}]]}]}]}]
13:["$","p",null,{"children":"In fact, you can merge the two documents:"}]
14:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"{"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    time"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#B392F0"},"children":"ISODate"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"("}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"\"2015-09-02T09:10:09.032Z\""}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"),"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    message"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'cpu is on fire!'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    ipaddr"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'127.66.66.66'"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B392F0"},"children":"    hostname"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" : "}],["$","span",null,{"style":{"color":"#9ECBFF"},"children":"'goofy.example.com'"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"}"}]}]]}]}]}]
15:["$","p",null,{"children":"It would be used like this in the code:"}]
16:["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#24292e","color":"#e1e4e8"},"tabIndex":"0","data-language":"javascript","data-theme":"github-dark","children":["$","code",null,{"data-language":"javascript","data-theme":"github-dark","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// receive log from monitoring program."}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"logmsg "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#B392F0"},"children":" get_log_msg"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"log_message_here "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" logmsg.msg;"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"log_ip "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" logmsg.ipaddr;"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// get timestamp"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"now "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#F97583"},"children":" new"}],["$","span",null,{"style":{"color":"#B392F0"},"children":" Date"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// find host's id for update"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"host_doc "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" db.hosts."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"findOne"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({ ipaddr: log_ip },{ _id: "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" });"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"host_id "}],["$","span",null,{"style":{"color":"#F97583"},"children":"="}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" host_doc._id;"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// save denoramlized data"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"db.logmsg."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"save"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    time : now,"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    message : log_message_here,"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    ipaddr : log_ip,"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    host : host_id ) });"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#6A737D"},"children":"// Push the denoramlized data in 'one'"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"db.hosts."}],["$","span",null,{"style":{"color":"#B392F0"},"children":"update"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":"( {_id: host_id }, {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    $push : {"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"      logmsgs : {"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"        $each:  [ { time : now, message : log_message_here } ],"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"        $sort:  { time : "}],["$","span",null,{"style":{"color":"#79B8FF"},"children":"1"}],["$","span",null,{"style":{"color":"#E1E4E8"},"children":" },  "}],["$","span",null,{"style":{"color":"#6A737D"},"children":"// sort by time"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#E1E4E8"},"children":"        $slice: "}],"$L1e","$L1f","$L20"]}],"\n","$L21","\n","$L22","\n","$L23"]}]}]}]
17:["$","h2",null,{"id":"6-rules-of-thumb","children":[[["$","a","link-6-rules-of-thumb",{"href":"#6-rules-of-thumb","className":"anchor"}]],"6 Rules of Thumb"]}]
18:["$","p",null,{"children":"Here are some \"rules of thumb\" to guide you through these innumerable (but not infinite) choices:"}]
19:["$","ol",null,{"children":["\n",["$","li",null,{"children":"Favor embedding unless there is a compelling reason not to"}],"\n",["$","li",null,{"children":"Needing to access an object on its own is a compelling reason not to embed it"}],"\n",["$","li",null,{"children":"Arrays should not grow without bound. If there are more than a couple of hundred documents on the \"many\" side, don't embed them; if there are more than a few thousand documents on the \"many\" side, don't use an array of ObjectID references. High-cardinality arrays are a compelling reason not to embed."}],"\n",["$","li",null,{"children":"Don't be afraid of application-level joins: if you index correctly and use the projection specifier then application-level joins are barely more expensive than server-side joins in a relational database."}],"\n",["$","li",null,{"children":"Consider the write/read ratio when denormalizing. A field that will mostly be read and only seldom updated is a good candidate for denormalization: if you denormalize a field that is updated frequently then the extra work of finding and updating all the instances is likely to overwhelm the savings that you get from denormalizing."}],"\n",["$","li",null,{"children":"As always with MongoDB, how you model your data depends – entirely – on your particular application's data access patterns. You want to structure your data to match the ways that your application queries and updates it."}],"\n"]}]
1a:["$","h2",null,{"id":"references","children":[[["$","a","link-references",{"href":"#references","className":"anchor"}]],"References"]}]
1b:["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-1","children":"6 Rules of Thumb for MongoDB Schema Design Part 1"}]}],"\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-2","children":"6 Rules of Thumb for MongoDB Schema Design Part 2"}]}],"\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-3","children":"6 Rules of Thumb for MongoDB Schema Design Part 3"}]}],"\n"]}]
1c:["$","script","script-0",{"src":"/_next/static/chunks/1ca67093247280ae.js","async":true}]
1d:["$","$L24",null,{"children":["$","$25",null,{"name":"Next.MetadataOutlet","children":"$@26"}]}]
1e:["$","span",null,{"style":{"color":"#F97583"},"children":"-"}]
1f:["$","span",null,{"style":{"color":"#79B8FF"},"children":"1000"}]
20:["$","span",null,{"style":{"color":"#6A737D"},"children":"          // get top 1000"}]
21:["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"      }"}]}]
22:["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"    }"}]}]
23:["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#E1E4E8"},"children":"  });"}]}]
26:null
