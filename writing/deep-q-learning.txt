1:"$Sreact.fragment"
2:I[4773,["205","static/chunks/205-e96f68d7203b15f6.js","177","static/chunks/app/layout-7515811826800637.js"],"ThemeProvider"]
3:I[9586,["205","static/chunks/205-e96f68d7203b15f6.js","194","static/chunks/194-a3fce70a81ebfe46.js","980","static/chunks/app/%5BcontentType%5D/%5Bslug%5D/page-d8e2278941ac5d63.js"],""]
4:I[5758,["205","static/chunks/205-e96f68d7203b15f6.js","177","static/chunks/app/layout-7515811826800637.js"],"ThemeToggle"]
5:I[4308,[],""]
6:I[834,[],""]
7:I[8641,["205","static/chunks/205-e96f68d7203b15f6.js","177","static/chunks/app/layout-7515811826800637.js"],"Analytics"]
8:I[6794,["205","static/chunks/205-e96f68d7203b15f6.js","177","static/chunks/app/layout-7515811826800637.js"],"SpeedInsights"]
a:I[7921,[],"OutletBoundary"]
c:I[2140,[],"AsyncMetadataOutlet"]
e:I[7921,[],"ViewportBoundary"]
10:I[7921,[],"MetadataBoundary"]
11:"$Sreact.suspense"
13:I[9216,[],""]
:HL["/_next/static/media/5b01f339abf2f1a5.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/4b6f991c45bff492.css","style"]
0:{"P":null,"b":"LN3xQXVA8Q64WAedwU1wd","p":"","c":["","writing","deep-q-learning"],"i":false,"f":[[["",{"children":[["contentType","writing","d"],{"children":[["slug","deep-q-learning","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4b6f991c45bff492.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"__variable_f910ec","suppressHydrationWarning":true,"children":["$","body",null,{"className":"font-mono antialiased max-w-2xl mx-4 mt-6 lg:mx-auto text-sm text-black bg-white dark:text-white dark:bg-black","children":["$","$L2",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"disableTransitionOnChange":true,"children":["$","main",null,{"className":"flex-auto min-w-0 mt-4 flex flex-col px-2 md:px-0","children":[["$","aside",null,{"className":"-ml-[8px] mb-8 tracking-tight","children":["$","div",null,{"className":"lg:sticky lg:top-20","children":["$","nav",null,{"className":"flex flex-row items-center justify-between relative px-0 pb-0 fade md:overflow-auto scroll-pr-6 md:relative","id":"nav","children":[["$","div",null,{"className":"flex flex-row space-x-0 pr-10","children":[["$","$L3","/",{"href":"/","className":"transition-all hover:bg-black hover:text-white dark:hover:bg-white dark:hover:text-black flex align-middle relative py-1 px-2 m-1","children":"home"}],["$","$L3","/writing",{"href":"/writing","className":"transition-all hover:bg-black hover:text-white dark:hover:bg-white dark:hover:text-black flex align-middle relative py-1 px-2 m-1","children":"writing"}]]}],["$","$L4",null,{}]]}]}]}],["$","$L5",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","section",null,{"children":[["$","h1",null,{"className":"mb-8 text-2xl font-semibold tracking-tighter","children":"404 - Page Not Found"}],["$","p",null,{"className":"mb-4","children":"The page you are looking for does not exist."}]]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}],["$","footer",null,{"className":"mb-4 mt-12","children":["$","div",null,{"className":"text-xs opacity-50","children":[["$","a",null,{"className":"hover:opacity-100 transition-opacity mr-3","rel":"noopener noreferrer","target":"_blank","href":"/rss","children":"rss"}],["$","a",null,{"className":"hover:opacity-100 transition-opacity mr-3","rel":"noopener noreferrer","target":"_blank","href":"https://github.com/keon","children":"github"}],["$","a",null,{"className":"hover:opacity-100 transition-opacity mr-3","rel":"noopener noreferrer","target":"_blank","href":"https://www.linkedin.com/in/keon/","children":"linkedin"}],["$","a",null,{"className":"hover:opacity-100 transition-opacity","rel":"noopener noreferrer","target":"_blank","href":"https://x.com/keonwkim","children":"x"}]]}]}],["$","$L7",null,{}],["$","$L8",null,{}]]}]}]}]}]]}],{"children":[["contentType","writing","d"],["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","deep-q-learning","d"],["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L9",null,["$","$La",null,{"children":["$Lb",["$","$Lc",null,{"promise":"$@d"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$Le",null,{"children":"$Lf"}],null],["$","$L10",null,{"children":["$","div",null,{"hidden":true,"children":["$","$11",null,{"fallback":null,"children":"$L12"}]}]}]]}],false]],"m":"$undefined","G":["$13",[]],"s":false,"S":true}
14:I[8268,["205","static/chunks/205-e96f68d7203b15f6.js","194","static/chunks/194-a3fce70a81ebfe46.js","980","static/chunks/app/%5BcontentType%5D/%5Bslug%5D/page-d8e2278941ac5d63.js"],"RelativeTime"]
9:["$","section",null,{"children":[["$","h1",null,{"className":"title font-bold text-lg","children":"Deep Q-Learning with Keras and Gym"}],["$","div",null,{"className":"flex justify-between items-center mt-1 mb-6 text-xs","children":["$","$L14",null,{"date":"2016-12-10"}]}],["$","article",null,{"className":"prose","children":"$L15"}]]}]
16:Tc46,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">reset</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_space</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">sample</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">info</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">step</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>15:[["$","p",null,{"children":"This blog post will demonstrate how deep reinforcement learning (deep Q-learning) can be implemented and applied to play a CartPole game using Keras and Gym, in less than 100 lines of code!"}],"\n",["$","p",null,{"children":"I'll explain everything without requiring any prerequisite knowledge about reinforcement learning."}],"\n",["$","p",null,{"children":["The code used for this article is on ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/keon/deep-q-learning","children":"GitHub"}],"."]}],"\n",["$","h2",null,{"id":"reinforcement-learning","children":[[["$","a","link-reinforcement-learning",{"href":"#reinforcement-learning","className":"anchor"}]],"Reinforcement Learning"]}],"\n",["$","p",null,{"children":"Reinforcement Learning is a type of machine learning that allows you to create AI agents that learn from the environment by interacting with it. Just like how we learn to ride a bicycle, this kind of AI learns by trial and error."}],"\n",["$","p",null,{"children":["Google's DeepMind published its famous paper ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://arxiv.org/abs/1312.5602","children":"Playing Atari with Deep Reinforcement Learning"}],", in which they introduced a new algorithm called Deep Q Network (DQN for short) in 2013. It demonstrated how a computer learned to play Atari 2600 video games by observing just the screen pixels and receiving a reward when the game score increased. The result was remarkable!"]}],"\n",["$","p",null,{"children":"In Q-Learning Algorithm, there is a function called Q Function, which is used to approximate the reward based on a state. We call it Q(s,a), where Q is a function which calculates the expected future value from state s and action a. Similarly in Deep Q Network algorithm, we use a neural network to approximate the reward based on the state. We will discuss how this works in detail."}],"\n",["$","h2",null,{"id":"cartpole-game","children":[[["$","a","link-cartpole-game",{"href":"#cartpole-game","className":"anchor"}]],"Cartpole Game"]}],"\n",["$","p",null,{"children":"Usually, training an agent to play an Atari game takes a while (from few hours to a day). So we will make an agent to play a simpler game called CartPole, but using the same idea used in the paper."}],"\n",["$","p",null,{"children":"CartPole is one of the simplest environments in OpenAI gym (a game simulator). As you can see in the animation, the goal of CartPole is to balance a pole connected with one joint on top of a moving cart. Instead of pixel information, there are 4 kinds of information given by the state, such as angle of the pole and position of the cart. An agent can move the cart by performing a series of actions of 0 or 1 to the cart, pushing it left or right."}],"\n",["$","p",null,{"children":"Gym makes interacting with the game environment really simple:"}],"\n",["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$16"},"className":"language-python"}]}],"\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a","\n","$L4b","\n","$L4c","\n","$L4d"]
17:["$","p",null,{"children":"As we discussed above, action can be either 0 or 1. If we pass those numbers, env, which represents the game environment, will emit the results. done is a boolean value telling whether the game ended or not."}]
18:["$","h2",null,{"id":"neural-network","children":[[["$","a","link-neural-network",{"href":"#neural-network","className":"anchor"}]],"Neural Network"]}]
19:["$","p",null,{"children":"This post is not about deep learning or neural nets. So we will consider neural net as just a black box algorithm that approximately maps inputs to outputs. It is basically an algorithm that learns one or more functions through training with data. A neural net has one input layer, one or more hidden layers, and one output layer. Each layer can have several nodes."}]
1a:["$","p",null,{"children":"Note that the neural net we are going to use is similar to the diagram above. We will have one input layer that receives 4 information and 3 hidden layers. But we are going to have 2 nodes in the output layer, because we are going to have two reward values for action 0 and 1."}]
1b:["$","p",null,{"children":"Keras makes it really simple to implement a basic neural network. The code below creates an empty neural net model. activation, loss and optimizer are the parameters that define the characteristics of the neural net."}]
4e:T1a6e,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">Sequential</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">add</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">Dense</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">24</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">input_dim</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">state_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">activation</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">relu</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">add</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">Dense</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">24</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">activation</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">relu</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">add</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">Dense</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">activation</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">linear</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">compile</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">loss</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">mse</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">optimizer</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">Adam</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">lr</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">learning_rate</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>1c:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$4e"},"className":"language-python"}]}]
1d:["$","p",null,{"children":["In order for a neural net to understand and predict based on the environment data, we have to feed it the information. ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">fit</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">(</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">)</span></span>"}}]," method feeds input and output pairs to the model. Then the model will train based on the inputs and outputs."]}]
4f:T5c3,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">fit</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">epochs</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">1</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">verbose</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>1e:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$4f"},"className":"language-python"}]}]
1f:["$","p",null,{"children":"This training process makes the neural net to predict the reward value from a certain state."}]
20:["$","p",null,{"children":["After training, the model now can predict the output from unseen input. When you call ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">predict</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">(</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">)</span></span>"}}]," function on the model, the model will predict the reward of current state based on the data you trained."]}]
21:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">act_values</span><span class=\"sh__token--space\" style=\"color:var(--sh-space)\"> </span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">=</span><span class=\"sh__token--space\" style=\"color:var(--sh-space)\"> </span><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">model</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">.</span><span class=\"sh__token--property\" style=\"color:var(--sh-property)\">predict</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">(</span><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">state</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">)</span><span class=\"sh__token--break\" style=\"color:var(--sh-break)\"></span></span>"},"className":"language-python"}]}]
22:["$","h2",null,{"id":"deep-q-learning-algorithm","children":[[["$","a","link-deep-q-learning-algorithm",{"href":"#deep-q-learning-algorithm","className":"anchor"}]],"Deep Q-Learning Algorithm"]}]
23:["$","p",null,{"children":"Normally in games, the reward directly relates to the score of the game. Imagine a situation where the pole from CartPole game is tilted to the right. The expected future reward of pushing right button would be higher than left. Why? Because the pole is tilted to the right so you want to balance the pole by pushing to the right!"}]
24:["$","p",null,{"children":"In order to logically represent this intuition and train it, we need to express this as a formula that we can optimize on. The loss is just a value that indicates how far our prediction is from the actual data. So by minimizing the loss, we can get our prediction close to the actual."}]
25:["$","p",null,{"children":"We first carry out an action a, and observe the reward r and resulting new state s'. Based on the result, we calculate the maximum target Q and then discount it so that the future reward is worth less than the immediate reward. We then add the immediate reward to the discounted future reward to get the target value (target_f)."}]
26:["$","p",null,{"children":"Keras takes care of the most of the difficult tasks for us. We just need to define our target. We can express the target in a magical one-liner in python:"}]
50:T6f0,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">target</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">+</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">gamma</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">*</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">amax</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">predict</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>27:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$50"},"className":"language-python"}]}]
28:["$","p",null,{"children":["Keras does all the work of subtracting the target from the neural network output and squaring it. It also applies the learning rate we defined while creating the neural network model. This all happens when you call ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">fit</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">(</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">)</span></span>"}}]," function."]}]
29:["$","h2",null,{"id":"dqn-improvements","children":[[["$","a","link-dqn-improvements",{"href":"#dqn-improvements","className":"anchor"}]],"DQN Improvements"]}]
2a:["$","p",null,{"children":"The most notable features of the DQN algorithm are memorize and replay methods. Both are pretty simple concepts. The original DQN architecture contains several more tweaks for better training, but we will focus on these two for now."}]
2b:["$","h3",null,{"id":"memorize","children":[[["$","a","link-memorize",{"href":"#memorize","className":"anchor"}]],"Memorize"]}]
2c:["$","p",null,{"children":"One of the challenges for DQN is that neural network used in the algorithm tends to forget the previous experiences as it overwrites them with new experiences. So we need a list of previous experiences and observations to re-train the model with the previous experiences."}]
2d:["$","p",null,{"children":"In our example, the memory list will have a form of:"}]
51:T7a5,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">memory</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>2e:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$51"},"className":"language-python"}]}]
2f:["$","p",null,{"children":"And memorize function will simply store states, actions and resulting rewards to the memory like below:"}]
52:Tdaa,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">def</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">remember</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">memory</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">append</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>30:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$52"},"className":"language-python"}]}]
31:["$","p",null,{"children":"done is just a boolean that indicates if the state is the final state."}]
32:["$","p",null,{"children":"Simple right?"}]
33:["$","h3",null,{"id":"replay","children":[[["$","a","link-replay",{"href":"#replay","className":"anchor"}]],"Replay"]}]
34:["$","p",null,{"children":["A method that trains the neural net with experiences in the memory is called ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">replay</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">(</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">)</span></span>"}}],". First, we sample some experiences from the memory and call them minibatch."]}]
53:T4b8,<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">minibatch</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">random</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">sample</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">memory</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">batch_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>35:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$53"},"className":"language-python"}]}]
36:["$","p",null,{"children":"The above code will make minibatch, which is just a randomly sampled elements of the memories of size batch_size. We set the batch size as 32 for this example."}]
37:["$","p",null,{"children":"To make the agent perform well in long-term, we need to take into account not only the immediate rewards but also the future rewards we are going to get. In order to do this, we are going to have a 'discount rate' or 'gamma'. This way the agent will learn to maximize the discounted future reward based on the given state."}]
38:["$","h2",null,{"id":"exploration-vs-exploitation","children":[[["$","a","link-exploration-vs-exploitation",{"href":"#exploration-vs-exploitation","className":"anchor"}]],"Exploration vs Exploitation"]}]
39:["$","p",null,{"children":["Our agent will randomly select its action at first by a certain percentage, called 'exploration rate' or 'epsilon'. This is because at first, it is better for the agent to try all kinds of things before it starts to see the patterns. When it is not deciding the action randomly, the agent will predict the reward value based on the current state and pick the action that will give the highest reward. ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">np</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">.</span><span class=\"sh__token--property\" style=\"color:var(--sh-property)\">argmax</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">(</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">)</span></span>"}}]," is the function that picks the highest value between two elements in the ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">act_values</span></span>"}}]," list."]}]
54:T101a,<span class="sh__line"><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">random</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">rand</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">&lt;</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">return</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">random</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">randrange</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color:var(--sh-identifier)">act_values</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">predict</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--keyword" style="color:var(--sh-keyword)">return</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">argmax</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">act_values</span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>3a:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$54"},"className":"language-python"}]}]
3b:["$","p",null,{"children":[["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color:var(--sh-identifier)\">act_values</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">[</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">0</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">]</span></span>"}}]," looks like this: ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">[</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">0</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">.</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">67</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">,</span><span class=\"sh__token--space\" style=\"color:var(--sh-space)\"> </span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">0</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">.</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">2</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">]</span></span>"}}],", each number representing the reward of picking action 0 and 1. And argmax function picks the index with the highest value. In the example of ",["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">[</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">0</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">.</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">67</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">,</span><span class=\"sh__token--space\" style=\"color:var(--sh-space)\"> </span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">0</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">.</span><span class=\"sh__token--class\" style=\"color:var(--sh-class)\">2</span><span class=\"sh__token--sign\" style=\"color:var(--sh-sign)\">]</span></span>"}}],", argmax returns 0."]}]
3c:["$","h2",null,{"id":"parameters","children":[[["$","a","link-parameters",{"href":"#parameters","className":"anchor"}]],"Parameters"]}]
3d:["$","p",null,{"children":"There are some parameters that have to be passed to a reinforcement learning agent. You will see these over and over again:"}]
3e:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"episodes"}]," - a number of games we want the agent to play."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"gamma"}]," - aka decay or discount rate, to calculate the future discounted reward."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"epsilon"}]," - aka exploration rate, this is the rate in which an agent randomly decides its action rather than prediction."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"epsilon_decay"}]," - we want to decrease the number of explorations as it gets good at playing games."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"epsilon_min"}]," - we want the agent to explore at least this amount."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"learning_rate"}]," - Determines how much neural net learns in each iteration."]}],"\n"]}]
3f:["$","h2",null,{"id":"dqnagent-class","children":[[["$","a","link-dqnagent-class",{"href":"#dqnagent-class","className":"anchor"}]],"DQNAgent Class"]}]
40:["$","p",null,{"children":"I explained each part of the agent in the above. The code below implements everything we've talked about as a nice and clean class called DQNAgent."}]
55:T9ead,<span class="sh__line"><span class="sh__token--keyword" style="color:var(--sh-keyword)">class</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">DQNAgent</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">def</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">__init__</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">state_size</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state_size</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_size</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action_size</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">memory</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">deque</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">maxlen</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">2000</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">gamma</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--class" style="color:var(--sh-class)">95</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--space" style="color:var(--sh-space)">   </span><span class="sh__token--sign" style="color:var(--sh-sign)">#</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">discount</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">rate</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">1</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">#</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">exploration</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">rate</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon_min</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--class" style="color:var(--sh-class)">01</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon_decay</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--class" style="color:var(--sh-class)">995</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">learning_rate</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--class" style="color:var(--sh-class)">001</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">model</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--class" style="color:var(--sh-class)">_build_model</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">def</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">_build_model</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">Sequential</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">add</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">Dense</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">24</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">input_dim</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">state_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">activation</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">relu</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">add</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">Dense</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">24</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">activation</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">relu</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">add</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">Dense</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">activation</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">linear</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">compile</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">loss</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">mse</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">optimizer</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">Adam</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">lr</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">learning_rate</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">return</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">model</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">def</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">remember</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">memory</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">append</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">def</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">act</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">random</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">rand</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">&lt;</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">return</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">random</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">randrange</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">act_values</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">predict</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">return</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">argmax</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">act_values</span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">def</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">replay</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">batch_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">minibatch</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">random</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">sample</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">memory</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">batch_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">for</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">in</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">minibatch</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">not</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">                </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">+</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">gamma</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">*</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">amax</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">predict</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target_f</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">predict</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target_f</span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">model</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">fit</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">target_f</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">epochs</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">1</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">verbose</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">&gt;</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon_min</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">*</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">self</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon_decay</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>41:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$55"},"className":"language-python"}]}]
42:["$","h2",null,{"id":"training","children":[[["$","a","link-training",{"href":"#training","className":"anchor"}]],"Training"]}]
43:["$","p",null,{"children":"The training part is even shorter. I'll explain in the comments."}]
56:T563b,<span class="sh__line"><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">__name__</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--string" style="color:var(--sh-string)">&quot;</span><span class="sh__token--string" style="color:var(--sh-string)">__main__</span><span class="sh__token--string" style="color:var(--sh-string)">&quot;</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">gym</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">make</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--string" style="color:var(--sh-string)">CartPole-v1</span><span class="sh__token--string" style="color:var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state_size</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">observation_space</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">shape</span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">0</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action_size</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">action_space</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">n</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">agent</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">DQNAgent</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">False</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">batch_size</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">32</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">    </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">for</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">e</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">in</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">range</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">EPISODES</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">reset</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">reshape</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">1</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">        </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">for</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">time</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">in</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">range</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--class" style="color:var(--sh-class)">500</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">agent</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">act</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">_</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">env</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">step</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">not</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">else</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">-</span><span class="sh__token--class" style="color:var(--sh-class)">10</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">np</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">reshape</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">[</span><span class="sh__token--class" style="color:var(--sh-class)">1</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">]</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">agent</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">remember</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">action</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">reward</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">state</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">=</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">next_state</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">done</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">                </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">print</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--string" style="color:var(--sh-string)">&quot;</span><span class="sh__token--string" style="color:var(--sh-string)">episode: {}/{}, score: {}, e: {:.2}</span><span class="sh__token--string" style="color:var(--sh-string)">&quot;</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">                      </span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">format</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">e</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--class" style="color:var(--sh-class)">EPISODES</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">time</span><span class="sh__token--sign" style="color:var(--sh-sign)">,</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">agent</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">epsilon</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">                </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">break</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">            </span><span class="sh__token--keyword" style="color:var(--sh-keyword)">if</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">len</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">agent</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">memory</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--sign" style="color:var(--sh-sign)">&gt;</span><span class="sh__token--space" style="color:var(--sh-space)"> </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">batch_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">:</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--space" style="color:var(--sh-space)">                </span><span class="sh__token--identifier" style="color:var(--sh-identifier)">agent</span><span class="sh__token--sign" style="color:var(--sh-sign)">.</span><span class="sh__token--property" style="color:var(--sh-property)">replay</span><span class="sh__token--sign" style="color:var(--sh-sign)">(</span><span class="sh__token--identifier" style="color:var(--sh-identifier)">batch_size</span><span class="sh__token--sign" style="color:var(--sh-sign)">)</span><span class="sh__token--break" style="color:var(--sh-break)"></span></span>44:["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$56"},"className":"language-python"}]}]
45:["$","h2",null,{"id":"result","children":[[["$","a","link-result",{"href":"#result","className":"anchor"}]],"Result"]}]
46:["$","p",null,{"children":"In the beginning, the agent explores by acting randomly."}]
47:["$","p",null,{"children":"It goes through multiple phases of learning:"}]
48:["$","ul",null,{"children":["\n",["$","li",null,{"children":"The cart masters balancing the pole."}],"\n",["$","li",null,{"children":"But goes out of bounds, ending the game."}],"\n",["$","li",null,{"children":"It tries to move away from the bounds when it is too close to them, but drops the pole."}],"\n",["$","li",null,{"children":"The cart masters balancing and controlling the pole."}],"\n"]}]
49:["$","p",null,{"children":"After several hundreds of episodes (took 10 min), it starts to learn how to maximize the score."}]
4a:["$","p",null,{"children":"The final result is the birth of a skillful CartPole game player!"}]
4b:["$","p",null,{"children":["The code used for this article is on ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/keon/deep-q-learning","children":"GitHub"}],". I added the saved weights for those who want to skip the training part."]}]
4c:["$","h2",null,{"id":"references","children":[[["$","a","link-references",{"href":"#references","className":"anchor"}]],"References"]}]
4d:["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://arxiv.org/abs/1312.5602","children":"Playing Atari with Deep Reinforcement Learning"}]}],"\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.nature.com/articles/nature14236","children":"Human-level Control Through Deep Reinforcement Learning"}]}],"\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.slideshare.net/carpedm20/ai-67616630","children":"Taehoon Kim's Deep Reinforcement Learning Slides"}]}],"\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/rlcode/reinforcement-learning","children":"Reinforcement Learning Examples by RLCode"}]}],"\n",["$","li",null,{"children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://neuro.cs.ut.ee/demystifying-deep-reinforcement-learning/","children":"Demystifying Deep Reinforcement Learning"}]}],"\n"]}]
f:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
b:null
57:I[8404,[],"IconMark"]
d:{"metadata":[["$","title","0",{"children":"Keon Kim"}],["$","meta","1",{"name":"description","content":"Keon's blog."}],["$","link","2",{"rel":"manifest","href":"/favicon/site.webmanifest","crossOrigin":"$undefined"}],["$","meta","3",{"name":"robots","content":"index, follow"}],["$","meta","4",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","meta","5",{"property":"og:title","content":"Keon Kim"}],["$","meta","6",{"property":"og:description","content":"Keon's blog."}],["$","meta","7",{"property":"og:url","content":"https://portfolio-blog-starter.vercel.app"}],["$","meta","8",{"property":"og:site_name","content":"Keon Kim"}],["$","meta","9",{"property":"og:locale","content":"en_US"}],["$","meta","10",{"property":"og:type","content":"website"}],["$","meta","11",{"name":"twitter:card","content":"summary"}],["$","meta","12",{"name":"twitter:title","content":"Keon Kim"}],["$","meta","13",{"name":"twitter:description","content":"Keon's blog."}],["$","link","14",{"rel":"icon","href":"/favicon/favicon-16x16.png","sizes":"16x16","type":"image/png"}],["$","link","15",{"rel":"icon","href":"/favicon/favicon-32x32.png","sizes":"32x32","type":"image/png"}],["$","link","16",{"rel":"icon","href":"/favicon/favicon.ico","sizes":"any"}],["$","link","17",{"rel":"apple-touch-icon","href":"/favicon/apple-touch-icon.png","sizes":"180x180","type":"image/png"}],["$","link","18",{"rel":"android-chrome-192x192","href":"/favicon/android-chrome-192x192.png"}],["$","link","19",{"rel":"android-chrome-512x512","href":"/favicon/android-chrome-512x512.png"}],["$","$L57","20",{}]],"error":null,"digest":"$undefined"}
12:"$d:metadata"
